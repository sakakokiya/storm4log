import net.sf.json.JSONArray;
import net.sf.json.JSONObject;

import java.util.ArrayList;
import java.util.List;

/**
 * Created by hp on 15-3-18.
 */
public class JsonParserTest {

    private static String getJsonKey(String jsonStr) {
        List<String> jprimaryKeys = new ArrayList<String>();
        jprimaryKeys.add("id");
        String keyStr = "";
        JSONObject jo = JSONObject.fromObject(jsonStr);
        String sdata = jo.getString("data");
        JSONObject jdata = JSONObject.fromObject(sdata);
        JSONObject jfields = jdata.getJSONObject("fields");
        String dbname = jdata.getString("schema");
        String tbname = jdata.getString("table");
        String oper = jdata.getString("operation");
        keyStr += dbname + "#" +tbname + "#";
        for(String s : jprimaryKeys) {
            if(jfields.containsKey(s)) {
                String kv = jfields.getString(s);
                keyStr += kv + "#";
            }
        }
        keyStr += oper;
        return keyStr;
    }

    public static void main(String[] args) {
        String jsonStr = "{\"code\":0,\"info\":{\"job-id\":\"2102172174092_sense\",\"content\":{\"db_tab_meta\":[{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_12\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_53\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_61\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_33\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_38\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_41\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_42\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_6\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_24\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_39\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_47\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_45\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_22\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_20\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_57\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_14\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_50\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_26\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_48\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_40\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_7\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_17\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_60\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_58\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_27\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_4\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_28\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_10\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_59\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_1\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_23\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_44\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_37\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_29\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_35\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_18\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_56\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_0\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_51\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_30\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_62\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_49\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_3\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_16\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_9\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_31\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_32\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_46\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_19\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_15\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_21\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_25\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_8\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_55\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_52\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_43\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_36\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_5\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_54\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_13\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_2\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_0\",\"tablename\":\"orders_11\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_34\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"},{\"dbname\":\"jdorders_1\",\"tablename\":\"orders_63\",\"sensefield\":\"customerName,address,phone,usermob,email,remark,userremark,orderftel,premark\"}]},\"update-time\":null,\"type\":null,\"create-time\":null,\"yn\":\"yes\"}}";
        JSONObject jo = JSONObject.fromObject(jsonStr);
        JSONObject jinfo = jo.getJSONObject("info");
        JSONObject jcontent = jinfo.getJSONObject("content");
        if(jcontent.containsKey("db_tab_meta")) {
            System.out.println("contain");
            JSONArray jarry = jcontent.getJSONArray("db_tab_meta");
        } else {
            System.out.println("not contain");
        }
        System.out.println(jcontent.toString());
    }
}
